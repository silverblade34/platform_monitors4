"use strict";(self["webpackChunkplatform_monitors4"]=self["webpackChunkplatform_monitors4"]||[]).push([[503],{5911:function(e,t,a){a.d(t,{WY:function(){return r},kQ:function(){return s},qW:function(){return n},v6:function(){return i}});var o=a(1076);const l="http://67.205.164.216:3000/api/v1";function s(e,t){return o.Z.post(`${l}/allEvents`,{cod_cuenta:e,cod_cliente:t})}function n(e){return o.Z.post(`${l}/createEvents`,e)}function i(e){return o.Z.post(`${l}/deleteEvents`,e)}function r(e){return o.Z.put(`${l}/editEvents`,e)}},3512:function(e,t,a){a.d(t,{M:function(){return n},y:function(){return s}});var o=a(2492),l=a.n(o);function s(e,t,a,o){l().fire({icon:t,html:`<p class="text-lg font-semibold">${a}</p>\n          <p class="text-base">${o}</p>`,showCancelButton:!1,confirmButtonText:"Aceptar",confirmButtonColor:"#006cac",reverseButtons:!0}).then((t=>{t.isConfirmed&&e()}))}function n(e,t,a){l().fire({icon:"question",html:`<p class="text-lg">${t}</p>`,showCancelButton:!0,reverseButtons:!0,confirmButtonText:a,confirmButtonColor:"#3b82f6",cancelButtonText:"Cancelar"}).then((t=>{t.isConfirmed&&e()}))}},5503:function(e,t,a){a.r(t),a.d(t,{default:function(){return q}});var o=a(3396),l=a(7312),s=a(3289),n=a(240),i=a(165);const r=(0,o._)("h1",{class:"font-bold text-xl title_poppins pb-5"},"Reporte de eventos",-1),c={class:"w-full rounded-lg bg-white shadow-md p-5"},d={class:"w-full grid grid-cols-11 gap-3 pb-5"},u={class:"w-full border"};function m(e,t,a,m,p,v){const g=(0,o.up)("ServerTableVue");return(0,o.wg)(),(0,o.iD)("div",null,[r,(0,o._)("div",c,[(0,o._)("div",d,[(0,o.Wm)(i.h,{label:"Fecha desde",type:"date","hide-details":"",class:"col-span-2",density:"compact",modelValue:m.dateFrom,"onUpdate:modelValue":t[0]||(t[0]=e=>m.dateFrom=e),variant:"outlined",color:"indigo"},null,8,["modelValue"]),(0,o.Wm)(i.h,{label:"Fecha hasta",type:"date","hide-details":"",class:"col-span-2",density:"compact",modelValue:m.dateTo,"onUpdate:modelValue":t[1]||(t[1]=e=>m.dateTo=e),variant:"outlined",color:"indigo"},null,8,["modelValue"]),(0,o.Wm)(i.h,{clearable:"",density:"compact",color:"indigo",modelValue:m.plate,"onUpdate:modelValue":t[2]||(t[2]=e=>m.plate=e),"prepend-inner-icon":"mdi-truck",label:"Placa","hide-details":"",variant:"outlined",class:"col-span-2"},null,8,["modelValue"]),(0,o.Wm)(n.rL,{label:"Tipo evento",items:m.listEventsData.map((e=>e.cod_evento)),variant:"outlined",class:"col-span-2",color:"indigo","hide-details":"",density:"compact",modelValue:m.type_event,"onUpdate:modelValue":t[3]||(t[3]=e=>m.type_event=e)},null,8,["items","modelValue"]),(0,o.Wm)(n.rL,{label:"Estado",items:["Todos","Sin Atender","En Gestion","Confirmado","Descartado"],variant:"outlined",class:"col-span-2",color:"indigo","hide-details":"",density:"compact",modelValue:m.state,"onUpdate:modelValue":t[4]||(t[4]=e=>m.state=e)},null,8,["modelValue"]),(0,o.Wm)(l.T,{color:"blue",class:"col-span-1 mt-1",onClick:m.searchEventsReport},{default:(0,o.w5)((()=>[(0,o.Wm)(s.t,null,{default:(0,o.w5)((()=>[(0,o.Uk)("mdi-magnify")])),_:1}),(0,o.Uk)(" Buscar")])),_:1},8,["onClick"])]),(0,o._)("div",u,[(0,o.Wm)(g,{dataFilter:m.dataFilter,searchstate:m.searchstate},null,8,["dataFilter","searchstate"])])])])}var p=a(5911),v=a(7139);function g(e,t,a,l,s,n){const i=(0,o.up)("v-data-table-server");return(0,o.wg)(),(0,o.j4)(i,{"items-per-page":l.itemsPerPageInitials,"onUpdate:itemsPerPage":t[0]||(t[0]=e=>l.itemsPerPageInitials=e),headers:l.headers,"items-length":l.totalItems,items:l.serverItems,loading:l.loading,"item-value":"name","onUpdate:options":l.loadItems,class:"table_server_events custom-scrollbar"},{["item.fecha_ultima_accion"]:(0,o.w5)((({item:e})=>[(0,o.Uk)((0,v.zw)(e.fecha_ultima_accion.split(" ")[0]),1)])),["item.hora_ultima_accion"]:(0,o.w5)((({item:e})=>[(0,o.Uk)((0,v.zw)(e.fecha_ultima_accion.split(" ")[1]),1)])),["item.list_comentarios"]:(0,o.w5)((({item:e})=>[(0,o.Uk)((0,v.zw)(e.list_comentarios&&e.list_comentarios.length>0?l.truncateText(e.list_comentarios[e.list_comentarios.length-1].comentario):""),1)])),["item.geocerca"]:(0,o.w5)((({item:e})=>[(0,o.Uk)((0,v.zw)(l.truncateText(e.geocerca)),1)])),["item.usuario"]:(0,o.w5)((({item:e})=>[(0,o.Uk)((0,v.zw)(e.list_comentarios&&e.list_comentarios.length>0?e.list_comentarios[e.list_comentarios.length-1].usuario:""),1)])),["item.nombre_usuario"]:(0,o.w5)((({item:e})=>[(0,o.Uk)((0,v.zw)(e.list_comentarios&&e.list_comentarios.length>0?e.list_comentarios[e.list_comentarios.length-1].nombre_completo:""),1)])),["item.segundos"]:(0,o.w5)((({item:e})=>[(0,o.Uk)((0,v.zw)(e.segundos)+" segundos ",1)])),_:2},1032,["items-per-page","headers","items-length","items","loading","onUpdate:options"])}var h=a(1076);const f="http://67.205.164.216:3000/api/v1";function _(e,t,a,o,l,s,n,i,r){return h.Z.post(`${f}/notifications/Report`,{cod_cuenta:e,cod_cliente:t,placa:a,cod_evento:o,descripcion_estado:l,fecha_inicio:s,fecha_fin:n,pageCount:i,pageNum:r})}var b=a(5470),y=a(7942),w=a(1002),k=a(582),P=a(1231),V=a(9666),T=a(4418),x=a(8161),S=a(3298),B=a(6049),H=a(4020),F=a(9094),E=a(2494),U=a(6107),I=a(4870),C=a(3766),W=a(1107),D=a(9888);const Z=(0,C.U)({itemsLength:{type:[Number,String],required:!0},...(0,H.Gj)(),...(0,b.Sz)(),...(0,y.p)()},"VDataTableServer"),G=(0,W.ev)()({name:"VDataTableServer",props:Z(),emits:{"update:modelValue":e=>!0,"update:page":e=>!0,"update:itemsPerPage":e=>!0,"update:sortBy":e=>!0,"update:options":e=>!0,"update:expanded":e=>!0,"update:groupBy":e=>!0},setup(e,t){let{emit:a,slots:l}=t;const{groupBy:s}=(0,T.my)(e),{sortBy:n,multiSort:i,mustSort:r}=(0,E.lx)(e),{page:c,itemsPerPage:d}=(0,H.FV)(e),u=(0,o.Fl)((()=>parseInt(e.itemsLength,10))),{columns:m,headers:p}=(0,x.IT)(e,{groupBy:s,showSelect:(0,I.Vh)(e,"showSelect"),showExpand:(0,I.Vh)(e,"showExpand")}),{items:v}=(0,S.hh)(e,m),{toggleSort:g}=(0,E.NV)({sortBy:n,multiSort:i,mustSort:r,page:c}),{opened:h,isGroupOpen:f,toggleGroup:_,extractRows:b}=(0,T.P_)({groupBy:s,sortBy:n}),{pageCount:C,setItemsPerPage:W}=(0,H.ku)({page:c,itemsPerPage:d,itemsLength:u}),{flatItems:Z}=(0,T.T5)(v,s,h),{isSelected:G,select:L,selectAll:z,toggleSelect:$,someSelected:A,allSelected:N}=(0,F.mH)(e,{allItems:v,currentPage:v}),{isExpanded:R,toggleExpand:Y}=(0,V.BM)(e),j=(0,o.Fl)((()=>b(v.value)));(0,B.D)({page:c,itemsPerPage:d,sortBy:n,groupBy:s,search:(0,I.Vh)(e,"search")}),(0,o.JJ)("v-data-table",{toggleSort:g,sortBy:n}),(0,U.AF)({VDataTableRows:{hideNoData:(0,I.Vh)(e,"hideNoData"),noDataText:(0,I.Vh)(e,"noDataText"),loading:(0,I.Vh)(e,"loading"),loadingText:(0,I.Vh)(e,"loadingText")}});const q=(0,o.Fl)((()=>({page:c.value,itemsPerPage:d.value,sortBy:n.value,pageCount:C.value,toggleSort:g,setItemsPerPage:W,someSelected:A.value,allSelected:N.value,isSelected:G,select:L,selectAll:z,toggleSelect:$,isExpanded:R,toggleExpand:Y,isGroupOpen:f,toggleGroup:_,items:j.value,groupedItems:Z.value,columns:m.value,headers:p.value})));(0,D.L)((()=>{const[t]=y.i.filterProps(e),[a]=w.I.filterProps(e),[s]=k.f.filterProps(e),[n]=P.Y.filterProps(e);return(0,o.Wm)(P.Y,(0,o.dG)({class:["v-data-table",{"v-data-table--loading":e.loading},e.class],style:e.style},n),{top:()=>l.top?.(q.value),default:()=>l.default?l.default(q.value):(0,o.Wm)(o.HY,null,[l.colgroup?.(q.value),(0,o.Wm)("thead",{class:"v-data-table__thead",role:"rowgroup"},[(0,o.Wm)(w.I,(0,o.dG)(a,{sticky:e.fixedHeader}),l)]),l.thead?.(q.value),(0,o.Wm)("tbody",{class:"v-data-table__tbody",role:"rowgroup"},[l.body?l.body(q.value):(0,o.Wm)(k.f,(0,o.dG)(s,{items:Z.value}),l)]),l.tbody?.(q.value),l.tfoot?.(q.value)]),bottom:()=>l.bottom?l.bottom(q.value):(0,o.Wm)(y.i,t,{prepend:l["footer.prepend"]})})}))}});var L=a(4239),z={props:{dataFilter:Object,searchstate:Boolean},components:{VDataTableServer:G},setup(e){const t=(0,I.iH)(10),a=(0,I.iH)([{title:"Codigo evento",align:"start",sortable:!1,key:"cod_evento"},{title:"Prioridad",key:"prioridad",sortable:!1,align:"start"},{title:"Placa",key:"placa",sortable:!1,align:"start"},{title:"Fecha evento",key:"fecha_actual",sortable:!1,align:"start"},{title:"Velocidad",key:"velocidad",sortable:!1,align:"end"},{title:"Latitud",key:"latitud",sortable:!1,align:"end"},{title:"Longitud",key:"longitud",sortable:!1,align:"end"},{title:"Direcci贸n",key:"direccion",sortable:!1,align:"start"},{title:"Geocerca",key:"geocerca",sortable:!1,align:"start"},{title:"Fecha ult. acci贸n",key:"fecha_ultima_accion",sortable:!1,align:"start"},{title:"Hora ult. acci贸n",key:"hora_ultima_accion",sortable:!1,align:"start"},{title:"Tiempo atenci贸n",key:"segundos",sortable:!1,align:"start"},{title:"Estado",key:"descripcion_estado",sortable:!1,align:"start"},{title:"Comentario",key:"list_comentarios",sortable:!1,align:"start"},{title:"Usuario",key:"usuario",sortable:!1,align:"end"},{title:"Nombre usuario",key:"nombre_usuario",sortable:!1,align:"end"}]),l=(0,I.iH)([]),s=(0,I.iH)(!0),n=(0,I.iH)(0),i=(0,I.iH)(""),r=(0,I.iH)(""),c=(0,I.iH)(""),d=(0,I.iH)(""),u=(0,I.iH)(""),m=(0,I.iH)(!1);(0,o.YP)((()=>e.dataFilter),(t=>{e.searchstate&&(m.value=t,i.value=t.plate,r.value=t.type_event,c.value=t.state,d.value=t.dateFrom,u.value=t.dateTo,v())}));const p=e=>e&&e.length>20?e.slice(0,20)+"...":e,v=async()=>{s.value=!0,await _(L.Z.state.codcuenta,L.Z.state.codcliente,i.value,r.value,c.value,d.value,u.value,t.value,1).then((e=>{l.value=l.value=e.data.data?e.data.data:[],n.value=e.data.totalEventos,s.value=!1}))},g=({page:e,itemsPerPage:t})=>{m.value?(s.value=!0,_(L.Z.state.codcuenta,L.Z.state.codcliente,i.value,r.value,c.value,d.value,u.value,t,e).then((e=>{l.value=e.data.data?e.data.data:[],n.value=e.data.totalEventos,s.value=!1})).catch((e=>{console.log(e)}))):s.value=!1};return{itemsPerPageInitials:t,headers:a,serverItems:l,loading:s,totalItems:n,plate:i,cod_evento:r,description_state:c,dateFrom:d,dateTo:u,truncateText:p,loadItems:g}}},$=a(89);const A=(0,$.Z)(z,[["render",g]]);var N=A,R=a(3512),Y={components:{ServerTableVue:N},setup(){const e=(0,I.iH)([]),t=(0,I.iH)(""),a=(0,I.iH)(""),l=(0,I.iH)(""),s=(0,I.iH)(""),n=(0,I.iH)(""),i=(0,I.iH)(!1),r=(0,I.iH)({});(0,o.bv)((()=>{(0,p.kQ)(L.Z.state.codcuenta,L.Z.state.codclienteAdmin).then((t=>{e.value=t.data.data?t.data.data[0].eventos:[]}))}));const c=()=>{""!=t.value&&""!=a.value?(i.value=!0,r.value={dateFrom:t.value,dateTo:a.value,plate:l.value,type_event:s.value,state:"Todos"==n.value?"":n.value}):(0,R.y)((()=>{}),"warning","Advertencia","Los campos fecha desde y fecha hasta son obligatorios")};return{dateFrom:t,dateTo:a,plate:l,type_event:s,state:n,listEventsData:e,dataFilter:r,searchstate:i,searchEventsReport:c}}};const j=(0,$.Z)(Y,[["render",m]]);var q=j}}]);
//# sourceMappingURL=503.9b8434aa.js.map